<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>教室ごとの写真撮影アプリ</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>教室ごとの写真撮影アプリ</h1>
        <form id="photoForm">
            <label for="classroomName">教室名:</label>
            <input type="text" id="classroomName" name="classroomName" required>
            <div id="photoSections"></div>
            <button type="button" onclick="handleDownload()">送信</button>
        </form>
        <div id="result"></div>
    </div>
    <footer>Made by Masahiro Higuchi.</footer>

    <script>
        const items = [
            "【機器】オーディオラック", "【機器】スクリーン", "【機器】スクリーン収納口", "【機器】AVラック全体",
            "【機器】AVラック物入れ", "【機器】有線マイク", "【機器】AVラック内ケーブル類", "【機器】その他のケーブル類",
            "【機器】BDリモコン", "【機器】DVDリモコン", "【機器】VHSリモコン", "【設備】BD本体",
            "【設備】DVD本体", "【設備】VHS本体", "【設備】PC本体", "【設備】CDカセットプレイヤー",
            "【設備】教卓全体", "【設備】操作盤", "【設備】操作盤ポート部分①", "【設備】操作盤ポート部分②",
            "【機器】OHC", "【機器】OHCボタン部分", "【機器】OHC側面", "【機器】マウス①",
            "【機器】マウス②", "【機器】キーボード①", "【機器】キーボード②", "【機器】卓上モニター",
            "【機器】ワイヤレスマイク①", "【機器】ワイヤレスマイク②", "【機器】ワイヤレスマイク③", "【機器】ワイヤレスマイク④",
            "【機器】ワイヤレスピンマイク①", "【機器】ワイヤレスピンマイク②", "【機器】マイク充電スタンド", "【機器】プロジェクター①",
            "【機器】プロジェクター①レンズ部", "【機器】プロジェクター①下部", "【機器】プロジェクター①側面1", "【機器】プロジェクター①側面2",
            "【機器】プロジェクター②", "【機器】プロジェクター②レンズ部", "【機器】プロジェクター②下部", "【機器】プロジェクター②側面1",
            "【機器】プロジェクター②側面2", "【機器】BIGPAD", "【機器】MAXHUB", "【機器】前方右側スピーカー",
            "【機器】前方中央スピーカー", "【機器】前方左側スピーカー", "【機器】後方右側スピーカー", "【機器】後方中央スピーカー",
            "【機器】後方左側スピーカー", "【機器】右側モニター①", "【機器】右側モニター②", "【機器】右側モニター③",
            "【機器】右側モニター④", "【機器】右側モニター⑤", "【機器】中央モニター①", "【機器】中央モニター②",
            "【機器】中央モニター③", "【機器】中央モニター④", "【機器】中央モニター⑤", "【機器】左側モニター①",
            "【機器】左側モニター②", "【機器】左側モニター③", "【機器】左側モニター④", "【機器】左側モニター⑤",
            "【設備】ワイヤレスマイク受信機①", "【設備】ワイヤレスマイク受信機②", "【設備】ワイヤレスマイク受信機③", "【教室】椅子",
            "【教室】机", "【教室】全景①", "【教室】全景②", "【教室】後方①",
            "【教室】後方②", "【教室】天井①", "【教室】天井②", "【設備】出席くん①",
            "【設備】出席くん②", "【設備】出席くん③", "【設備】出席くん④", "【教室】座席表",
            "【設備】ワイヤレスマイク受信機", "【機器】その他", "【機器】その他", "【機器】その他",
            "【機器】その他", "【機器】その他", "【機器】その他", "【機器】その他",
            "【機器】その他", "【機器】その他", "【機器】その他", "【機器】その他",
            "【機器】その他", "【機器】その他", "【機器】その他", "【機器】その他",
            "【機器】その他", "【機器】その他"
        ];

        function createPhotoSections() {
            const photoSections = document.getElementById('photoSections');
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'photo-section';

                const label = document.createElement('label');
                label.htmlFor = item;
                label.innerText = item;
                div.appendChild(label);

                const input = document.createElement('input');
                input.type = 'file';
                input.id = item;
                input.name = item;
                input.accept = 'image/*';
                div.appendChild(input);

                photoSections.appendChild(div);
            });
        }

        function handleDownload() {
            const classroomName = document.getElementById('classroomName').value;

            if (!classroomName) {
                alert("教室名を入力してください。");
                return;
            }

            const files = items.map(item => {
                const fileInput = document.getElementById(item);
                return { file: fileInput.files[0], label: item };
            }).filter(entry => entry.file !== undefined);

            if (files.length === 0) {
                document.getElementById('result').innerHTML = '少なくとも1つの写真をアップロードしてください。';
                return;
            }

            const zip = new JSZip();
            const folder = zip.folder(classroomName);

            files.forEach(({ file, label }) => {
                const newFileName = `${classroomName}${label}${file.name.substring(file.name.lastIndexOf('.'))}`;
                folder.file(newFileName, file);
            });

            zip.generateAsync({ type: 'blob' }).then(function(content) {
                saveAs(content, `${classroomName}.zip`);
                document.getElementById('result').innerHTML = 'ファイルがダウンロードされました。';
            });
        }

        window.onload = createPhotoSections;
    </script>
</body>
</html>
